<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.8"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>Leosac: AuthFile Module Documentation</title>
        <!--<link href="../../tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="../../dynsections.js"></script>
        <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
        <link href="../../doxygen.css" rel="stylesheet" type="text/css" />
        <link href="../../customdoxygen.css" rel="stylesheet" type="text/css"/>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">Leosac </a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AuthFile Module Documentation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#mod_auth_file_intro">Introduction </a></li>
<li class="level1"><a href="#mod_auth_file_user_config">Configuration Options </a></li>
<li class="level1"><a href="#mod_auth_user">Users </a><ul><li class="level2"><a href="#mod_auth_user_declare">Declaring the users </a><ul><li class="level3"><a href="#mod_auth_user_declare_example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#mod_auth_cred">Credentials Type </a><ul><li class="level2"><a href="#mod_auth_cred_wiegandcard">WiegandCard </a></li>
<li class="level2"><a href="#mod_auth_cred_pincode">PINCode </a></li>
<li class="level2"><a href="#mod_auth_cred_wiegandcard_pin">WiegandCardPin </a></li>
<li class="level2"><a href="#mod_auth_cred_example">Example </a></li>
</ul>
</li>
<li class="level1"><a href="#mod_auth_group">Groups </a><ul><li class="level2"><a href="#mod_auth_user_to_group">Mapping user to group </a></li>
</ul>
</li>
<li class="level1"><a href="#mod_auth_schedule">Schedules </a><ul><li class="level2"><a href="#mod_auth_sched_declare">Declaring schedules </a><ul><li class="level3"><a href="#mod_auth_sched_declare_example">Example</a></li>
</ul>
</li>
<li class="level2"><a href="#mod_auth_schedule_map">Schedules Mapping </a><ul><li class="level3"><a href="#mod_auth_schedule_map_example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#mod_auth_file_example">Example </a></li>
<li class="level1"><a href="#mod_auth_file_notes">Notes </a></li>
</ul>
</div>
<div class="textblock"><p>Documentation for a backend authentication module that stores its config in XML.</p>
<h1><a class="anchor" id="mod_auth_file_intro"></a>
Introduction </h1>
<p>The module Auth-File is an <b>authentication backend</b> module. It listens to events generated by <b>authentication source</b> module (like <code>Wiegand</code>). These events contains credentials. This module verify the credential and either grant or deny access. Granting or denying access means sending a message to the application. This module doesn't open a door or perform action on its own.</p>
<dl class="section note"><dt>Note</dt><dd>This module is suitable only for a low number of users / cards / groups. The whole configuration lives in memory so this is where this limitation comes from.</dd></dl>
<h1><a class="anchor" id="mod_auth_file_user_config"></a>
Configuration Options </h1>
<table class="doxtable">
<tr>
<th>Options </th><th>Options </th><th>Description </th><th>Mandatory  </th></tr>
<tr>
<td>instances </td><td></td><td>List of configured auth file instance </td><td>YES </td></tr>
<tr>
<td>&mdash;&gt; </td><td>name </td><td>Configure of one particular led device </td><td>YES </td></tr>
<tr>
<td>&mdash;&gt; </td><td>auth_source </td><td>Which device (auth source) we listen to. Can appear multiple times. </td><td>YES </td></tr>
<tr>
<td>&mdash;&gt; </td><td>config_file </td><td>Path to the config file that holds permissions data </td><td>YES </td></tr>
<tr>
<td>&mdash;&gt; </td><td>target </td><td>Name of the target (door) that we are authenticating against </td><td>NO </td></tr>
</table>
<p>Notes:</p><ul>
<li>If the <code>target</code> is not present, the module assumes the default target, and will ignore target-specific permissions.</li>
<li>the <code>config_file</code> path is relative to the working directory of Leosac.</li>
<li>You can enter multiple <code>auth_source</code> device. The module instance will listen to all of them.</li>
</ul>
<dl class="section warning"><dt>Warning</dt><dd>The <code>target</code> field is prefixed by the instance name and a dot when checking for permission in the permission configuration file. This makes it easier to synchronize: you put all configuration in the permission file and simply sync everything, the name of the door will adapt based on the instance name. Assuming <code>instance_name</code> being <code>rpi-1</code> and <code>target</code> being <code>door1</code> the matching name in the permission file shall be <code>rpi-1.door1</code>.</dd></dl>
<h1><a class="anchor" id="mod_auth_user"></a>
Users </h1>
<p>Users are obviously a core component of an authentication module. The users will map to group, credentials, etc. Users can hold additional property, like their name, email address, or the status of their account (<code>enabled</code>, or <code>disabled</code>).</p>
<h2><a class="anchor" id="mod_auth_user_declare"></a>
Declaring the users </h2>
<p>This section is about describing how to declare users. This takes place in the additional config file.</p>
<table class="doxtable">
<tr>
<th>Options </th><th>Options </th><th>Options </th><th>Description </th><th>Mandatory  </th></tr>
<tr>
<td>users </td><td></td><td></td><td>List of users we declare </td><td>YES </td></tr>
<tr>
<td>&mdash;&gt; </td><td>user </td><td></td><td>Declaration of one user </td><td>YES </td></tr>
<tr>
<td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>name </td><td>Globally unique name to identify a user. </td><td>YES </td></tr>
<tr>
<td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>firstname </td><td>The firstname of the user. </td><td>NO </td></tr>
<tr>
<td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>lastname </td><td>The family name of the user </td><td>NO </td></tr>
<tr>
<td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>email </td><td>An email address for the user. </td><td>NO </td></tr>
<tr>
<td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>validity_start </td><td>Date when the user starts becoming valid / enabled </td><td>NO </td></tr>
<tr>
<td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>validity_end </td><td>Date when the user becomes invalid / disabled </td><td>NO </td></tr>
<tr>
<td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>enabled </td><td>A boolean to fully enable or disable an account </td><td>NO (defaults to <code>true</code>) </td></tr>
</table>
<p>The datetime format for <code>validity_{start,end}</code> is this: <code>d/m/Y H:M</code> (see man (3) <code>strptime</code>).</p>
<h3><a class="anchor" id="mod_auth_user_declare_example"></a>
Example</h3>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;users&gt;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    &lt;user&gt;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        &lt;name&gt;edgar_hoover&lt;/name&gt;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        &lt;firstname&gt;Edgar&lt;/firstname&gt;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        &lt;lastname&gt;Hoover&lt;/lastime&gt;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        &lt;email&gt;eh@fbi.gov&lt;/email&gt;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        &lt;validity_start&gt;25/10/2015 17:05&lt;/validity_start&gt;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    &lt;/user&gt;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;&lt;/users&gt;</div>
</div><!-- fragment --><h1><a class="anchor" id="mod_auth_cred"></a>
Credentials Type </h1>
<p>A credentials maps to a user.</p>
<p>3 types of credentials are supported:</p><ol type="1">
<li>WiegandCard</li>
<li>PINCode</li>
<li>WiegandCardPin</li>
</ol>
<p>All credentials type share 4 optional properties that you can configure per credentials:</p><ol type="1">
<li><code>id</code>: The id of the credentials. Used when mapping credentials to schedules. This can be whatever you want, as long as it is unique.</li>
<li><code>enabled</code>: Is the card active? If true, the credentials can be used, otherwise it will look like it doesn't exist.</li>
<li><code>validity_start</code>: Optional date at which the credentials becomes active.</li>
<li><code>validity_end</code>: Optional date at which the credentials stops being active</li>
</ol>
<p>It is possible to omit the <code>id</code> field. It is necessary only if you plan to map credentials directly to schedules, instead of mapping user to schedules. The direct mapping of credentials to schedules can be used to create temporary cards with more privilege than the user usually have.</p>
<h2><a class="anchor" id="mod_auth_cred_wiegandcard"></a>
WiegandCard </h2>
<p>This credentials is simply a Wiegand card number. It is qualified through a string representing the card id, and an integer representing the number of meaningful bits in the card id.</p>
<table class="doxtable">
<tr>
<th>Options </th><th>Options </th><th>Description </th><th>Mandatory  </th></tr>
<tr>
<td>WiegandCard </td><td></td><td>Defines a WiegandCard credential </td><td>NO </td></tr>
<tr>
<td>&mdash;&gt; </td><td>card_id </td><td>The id of the card, text string (<code>aa:bb:cc:dd</code>) </td><td><b>YES</b> </td></tr>
<tr>
<td>&mdash;&gt; </td><td>bits </td><td>Number of meaningful bits </td><td><b>YES</b> </td></tr>
</table>
<h2><a class="anchor" id="mod_auth_cred_pincode"></a>
PINCode </h2>
<p>This credentials is simply a PIN code. The number of character in the code is variable.</p>
<table class="doxtable">
<tr>
<th>Options </th><th>Options </th><th>Description </th><th>Mandatory  </th></tr>
<tr>
<td>PINCode </td><td></td><td>Defines a PINCode that will be a credentials </td><td>NO </td></tr>
<tr>
<td>&mdash;&gt; </td><td>pin </td><td>The PIN code to be used. This is a string. </td><td><b>YES</b> </td></tr>
</table>
<h2><a class="anchor" id="mod_auth_cred_wiegandcard_pin"></a>
WiegandCardPin </h2>
<p>This is the combination of a PIN code a WiegandCard. This is currently the most complex credential type.</p>
<table class="doxtable">
<tr>
<th>Options </th><th>Options </th><th>Description </th><th>Mandatory  </th></tr>
<tr>
<td>WiegandCardPin </td><td></td><td>Defines a credentials composed of a card and a PIN code </td><td>NO </td></tr>
<tr>
<td>&mdash;&gt; </td><td>pin </td><td>The PIN code to be used. This is a string. </td><td><b>YES</b> </td></tr>
<tr>
<td>&mdash;&gt; </td><td>card_id </td><td>The id of the card, text string (<code>aa:bb:cc:dd</code>) </td><td><b>YES</b> </td></tr>
<tr>
<td>&mdash;&gt; </td><td>bits </td><td>Number of meaningful bits </td><td><b>YES</b> </td></tr>
</table>
<h2><a class="anchor" id="mod_auth_cred_example"></a>
Example </h2>
<p>Below an example for each of those credentials:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;credentials&gt;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    &lt;map&gt;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        &lt;user&gt;llamasticot&lt;/user&gt;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        &lt;WiegandCard&gt;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;            &lt;card_id&gt;aa:bb:cc:dd&lt;/card_id&gt;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;            &lt;bits&gt;32&lt;/bits&gt;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;            &lt;enabled&gt;false&lt;/enabled&gt;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        &lt;/WiegandCard&gt;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    &lt;/map&gt;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    &lt;map&gt;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        &lt;user&gt;MY_USER&lt;/user&gt;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        &lt;PINCode&gt;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;            &lt;id&gt;my_unique_id_for_this_cred&lt;/id&gt;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;            &lt;pin&gt;1234&lt;/pin&gt;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        &lt;/PINCode&gt;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    &lt;/map&gt;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    &lt;map&gt;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        &lt;user&gt;Toto&lt;/user&gt;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        &lt;WiegandCardPin&gt;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;            &lt;card&gt;cc:dd:ee:ff&lt;/card&gt;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;            &lt;pin&gt;1234&lt;/pin&gt;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        &lt;/WiegandCardPin&gt;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    &lt;/map&gt;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;&lt;/credentials&gt;</div>
</div><!-- fragment --><h1><a class="anchor" id="mod_auth_group"></a>
Groups </h1>
<p>The module also supports groups. A user can be in multiple groups, and will collect permissions from all the groups he's a member of.</p>
<p>There is no definition of groups, they are lazily created when mapping users to them.</p>
<h2><a class="anchor" id="mod_auth_user_to_group"></a>
Mapping user to group </h2>
<p>A <code>&lt;group_mapping&gt;</code> block can be used to map user to groups.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;group_mapping&gt;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    &lt;map&gt;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        &lt;group&gt;Admins&lt;/group&gt;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        &lt;user&gt;MY_USER&lt;/user&gt;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        &lt;user&gt;Toto&lt;/user&gt;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    &lt;/map&gt;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;&lt;/group_mapping&gt;</div>
</div><!-- fragment --><p><b>Note</b>: It is <em>not</em> possible to map credentials directly to group.</p>
<h1><a class="anchor" id="mod_auth_schedule"></a>
Schedules </h1>
<p>Schedules can be defined. They represents time-frame where access <b>is granted</b>. Schedules are then mapped to user or to group.</p>
<p>They can apply to any <code>auth_target</code> (aka doors) or they can target specific doors only. This is configured when mapping a schedule, so that the same schedule can be better reused.</p>
<p>See below for an example of how to declare schedules.</p>
<h2><a class="anchor" id="mod_auth_sched_declare"></a>
Declaring schedules </h2>
<table class="doxtable">
<tr>
<th>Options </th><th>Options </th><th>Options </th><th>Options </th><th>Description </th><th>Mandatory  </th></tr>
<tr>
<td>schedules </td><td></td><td></td><td></td><td>We declare our schedules here </td><td>YES </td></tr>
<tr>
<td>&mdash;&gt; </td><td>schedule </td><td></td><td></td><td>Description of on schedule entry </td><td>YES </td></tr>
<tr>
<td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>name </td><td></td><td>A unique name for a schedule </td><td>YES </td></tr>
<tr>
<td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>"weekday" </td><td></td><td>A day of the week (<code>monday</code>, <code>sunday</code>, ...) </td><td>NO </td></tr>
<tr>
<td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>start </td><td>Start hour (format is <code>hh:mm</code>) </td><td>NO </td></tr>
<tr>
<td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>end </td><td>End hour (format is <code>hh:mm</code>) </td><td>NO </td></tr>
</table>
<h3><a class="anchor" id="mod_auth_sched_declare_example"></a>
Example</h3>
<p>This is a simple example that declares one schedule, named <code>my_schedule</code>. It would grants access anytime on monday, and wednesday from 11h to 13h and from 17h to 19h.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;schedules&gt;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    &lt;schedule&gt;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        &lt;name&gt;my_schedule&lt;/name&gt;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;         &lt;monday&gt;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;            &lt;start&gt;00:00&lt;/start&gt;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;            &lt;end&gt;23:59&lt;/end&gt;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        &lt;/monday&gt;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        &lt;wednesday&gt;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;            &lt;start&gt;11:00&lt;/start&gt;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;            &lt;end&gt;13:00&lt;/end&gt;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        &lt;/wednesday&gt;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        &lt;wednesday&gt;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;            &lt;start&gt;17:00&lt;/start&gt;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;            &lt;end&gt;19:00&lt;/end&gt;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        &lt;/wednesday&gt;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    &lt;/schedule&gt;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;&lt;/schedules&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="mod_auth_schedule_map"></a>
Schedules Mapping </h2>
<p>Schedules can, or rather must, be referenced by name. They can be mapped to either <code>users</code>, <code>groups</code>, or directly to <code>credentials</code>.</p>
<table class="doxtable">
<tr>
<th>Options </th><th>Options </th><th>Options </th><th>Description </th><th>Mandatory  </th></tr>
<tr>
<td>schedules_mapping </td><td></td><td></td><td>Defines the mapping between schedule and user/group/we </td><td>YES </td></tr>
<tr>
<td>&mdash;&gt; </td><td>map </td><td></td><td>One mapping entry </td><td>YES </td></tr>
<tr>
<td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>schedule </td><td>Which schedule are we mapping </td><td>YES </td></tr>
<tr>
<td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>user </td><td>To which user are we applying the schedule(s) </td><td>NO </td></tr>
<tr>
<td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>group </td><td>To which group are we applying the schedules(s) </td><td>NO </td></tr>
<tr>
<td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>credential </td><td>To which credential (identified by its <code>id</code>) do we apply the schedule </td><td>NO </td></tr>
<tr>
<td>&mdash;&gt; </td><td>&mdash;&gt; </td><td>door </td><td>Name of the auth target the mapping apply to </td><td>NO </td></tr>
</table>
<p>Note that <code>schedule</code>, <code>user</code> and <code>group</code> can be used multiple times in the same mapping entry.</p>
<h3><a class="anchor" id="mod_auth_schedule_map_example"></a>
Example</h3>
<p>There is 2 mappings entry in the following example.</p><ol type="1">
<li>The first maps 2 schedules, <code>name_of_schedule</code> and <code>name_of_another_schedule</code> and applies them to the user <code>My_User</code>, <code>A_Second_User</code> and to anyone who is a member of the group <code>the_whole_group_has_the_schedule</code>.</li>
<li>The seconds enable the <code>sysadmin_access_schedule</code> to the <code>sysadmins</code> group when the authentication attempt target the <code>sysadmin_room</code>. See the <code>target</code> field in the <a class="el" href="../../d0/d25/mod_auth_file_main.html#mod_auth_file_user_config">module options</a>.</li>
</ol>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;schedules_mapping&gt;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;   &lt;map&gt;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;       &lt;schedule&gt;name_of_schedule&lt;/schedule&gt;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;       &lt;schedule&gt;name_of_another_schedule&lt;/schedule&gt;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;       &lt;user&gt;My_User&lt;/user&gt;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;       &lt;user&gt;A_Second_User&lt;/user&gt;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;       &lt;group&gt;the_whole_group_has_the_schedule&lt;/group&gt;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;   &lt;/map&gt;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;   &lt;map&gt;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;       &lt;schedule&gt;sysadmin_access_schedule&lt;/schedule&gt;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;       &lt;group&gt;sysadmins&lt;/group&gt;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;       &lt;door&gt;sysadmin_room&lt;/door&gt;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;   &lt;/map&gt;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;&lt;/schedules_mapping&gt;</div>
</div><!-- fragment --><h1><a class="anchor" id="mod_auth_file_example"></a>
Example </h1>
<p>This is the module configuration in the main config file.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;module&gt;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    &lt;name&gt;AUTH-MANAGER-FILE&lt;/name&gt;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    &lt;file&gt;libauth-file.so&lt;/file&gt;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    &lt;level&gt;41&lt;/level&gt;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    &lt;module_config&gt;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        &lt;instances&gt;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;            &lt;instance&gt;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;                &lt;name&gt;AUTH_CONTEXT_1&lt;/name&gt;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;                &lt;auth_source&gt;MY_WIEGAND_1&lt;/auth_source&gt;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;                &lt;auth_source&gt;MY_WIEGAND_2&lt;/auth_source&gt;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                &lt;config_file&gt;file_auth.xml&lt;/config_file&gt;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;            &lt;/instance&gt;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        &lt;/instances&gt;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    &lt;/module_config&gt;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;&lt;/module&gt;</div>
</div><!-- fragment --><p>This is a possible content of the file designed by the <code>config_field</code> config entry for the module ("file_auth.xml" based on the previous example).</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;root&gt;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    &lt;users&gt;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        &lt;user&gt;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;            &lt;name&gt;MY_USER&lt;/name&gt;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        &lt;/user&gt;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    &lt;/users&gt;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    &lt;credentials&gt;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        &lt;map&gt;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;            &lt;user&gt;MY_USER&lt;/user&gt;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;            &lt;WiegandCard&gt;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;                &lt;card_id&gt;80:83:a0:40&lt;/card_id&gt;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                &lt;bits&gt;32&lt;/bits&gt;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;            &lt;/WiegandCard&gt;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        &lt;/map&gt;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        &lt;map&gt;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;            &lt;user&gt;MY_USER&lt;/user&gt;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;            &lt;PINCode&gt;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                &lt;pin&gt;1234&lt;/pin&gt;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;            &lt;/PINCode&gt;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        &lt;/map&gt;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    &lt;/credentials&gt;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    &lt;schedules&gt;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        &lt;schedule&gt;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;            &lt;name&gt;all&lt;/name&gt;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;            </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;            &lt;monday&gt;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                &lt;start&gt;00:00&lt;/start&gt;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                &lt;end&gt;23:59&lt;/end&gt;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            &lt;/monday&gt;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            &lt;tuesday&gt;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                &lt;start&gt;00:00&lt;/start&gt;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                &lt;end&gt;23:59&lt;/end&gt;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            &lt;/tuesday&gt;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            &lt;wednesday&gt;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                &lt;start&gt;00:00&lt;/start&gt;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                &lt;end&gt;23:59&lt;/end&gt;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            &lt;/wednesday&gt;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            &lt;sunday&gt;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                &lt;start&gt;00:00&lt;/start&gt;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                &lt;end&gt;23:59&lt;/end&gt;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            &lt;/sunday&gt;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        &lt;/schedule&gt;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    &lt;/schedules&gt;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    &lt;schedules_mapping&gt;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        &lt;map&gt;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            &lt;schedule&gt;all&lt;/schedule&gt;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            &lt;user&gt;MY_USER&lt;/user&gt;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        &lt;/map&gt;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    &lt;/schedules_mapping&gt;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;&lt;/root&gt;</div>
</div><!-- fragment --><h1><a class="anchor" id="mod_auth_file_notes"></a>
Notes </h1>
<p>Check the <a class="el" href="../../da/df8/classLeosac_1_1Module_1_1Auth_1_1AuthFileModule.html">module object documentation</a>. </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated on Thu Nov 19 2015 14:16:50 for Leosac by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
